var kclient=angular.module("kurentinoClient",["templatescache"]);kclient.config(function(e){e.debugEnabled(!0)}),kclient.controller("mainCtrl",function(e){e.vars={socket:new WebSocket("ws://localhost:8025"),logged:!1},e.clientMsgTypes={LOGIN:"login",LOGOUT:"logout",CLIENT_ERROR:"error"},e.serverMsgTypes={COME_IN:"comein",SERVER_ERROR:"error"};var n=function(){e.$on("$destroy",function(){window.onbeforeunload=void 0}),e.$on("$locationChangeStart",function(n,o,t){confirm("Вы действительно хотите уйти со страницы?")&&(e.vars.socket.close(),n.preventDefault())}),e.vars.loginName="Роман",e.vars.roomName="Тест"};e.login=function(){console.log("Логинимся: "+e.vars.loginName+", комната - "+e.vars.roomName);var n={id:e.clientMsgTypes.LOGIN,name:e.vars.loginName,room:e.vars.roomName};e.sendMessage(n)},e.sendMessage=function(n){var o=JSON.stringify(n);console.log("Сообщение на сервер: "+o),e.vars.socket.send(o)},e.vars.socket.onmessage=function(n){var o=JSON.parse(n.data);switch(o.id){case e.serverMsgTypes.COME_IN:console.log("Вам позволено войти в комнату"),e.logged=!0;break;case e.serverMsgTypes.SERVER_ERROR:console.log("Ошибка сервера");break;default:console.log("Обработчик сообщения еще не имплементирован")}},n()}),kclient.directive("peerViewer",function(e){return{restrict:"E",replace:!0,template:e.get("./dist/kc-peer-viewer/template.html"),scope:!0,link:function(e,n,o){e.width=parseInt(o.width,10),e.height=parseInt(o.height,10),e.videoElem=n.find("video")[0]}}}),kclient.directive("callContainer",function(e){return{restrict:"E",replace:!0,template:e.get("./dist/kc-call-container/template.html"),scope:!0,link:function(e,n,o){e.connectedPeers=[],e.connectedPeers.push({id:1,width:400,height:300}),e.connectedPeers.push({id:2,width:400,height:300})}}});